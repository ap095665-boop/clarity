<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Void</title>

<style>
html,body{
margin:0;
padding:0;
background:black;
font-family:monospace;
height:100%;
width:100%;
overflow:hidden;
color:#aaa;
}

/* container */
.container{
position:relative;
width:92%;
max-width:700px;
margin:auto;
top:50%;
transform:translateY(-50%);
text-align:center;
}

.title{
color:#666;
margin-bottom:18px;
font-size:clamp(16px,4vw,22px);
letter-spacing:2px;
}

textarea{
width:100%;
height:30vh;
min-height:140px;
max-height:260px;
background:rgba(0,0,0,.6);
border:1px solid #333;
color:#fff;
font-size:clamp(16px,4.5vw,22px);
padding:18px;
outline:none;
resize:none;
box-sizing:border-box;
}

button{
margin-top:20px;
padding:14px 30px;
background:black;
color:#aaa;
border:1px solid #444;
font-size:14px;
letter-spacing:3px;
}

/* dissolve text */
#layer{
position:absolute;
top:50%;
left:50%;
transform:translate(-50%,-50%);
width:92%;
max-width:700px;
font-size:clamp(18px,5vw,28px);
color:white;
line-height:1.6;
text-align:center;
pointer-events:none;
}

.letter{
display:inline-block;
transition:all 9s linear;
opacity:1;
}

.fly{
opacity:0;
transform:translateY(-220px) scale(2.2) rotate(25deg);
filter:blur(10px);
}

/* animated background */
.bg{
position:fixed;
width:200%;
height:200%;
top:-50%;
left:-50%;
background:radial-gradient(circle,#111 0%,black 60%);
animation:bgmove 20s linear infinite;
opacity:.7;
z-index:-2;
}

@keyframes bgmove{
0%{transform:scale(1);}
50%{transform:scale(1.4);}
100%{transform:scale(1);}
}

/* particles */
.particles{
position:fixed;
top:0;
left:0;
width:100%;
height:100%;
pointer-events:none;
z-index:-1;
overflow:hidden;
}

.p{
position:absolute;
width:2px;
height:2px;
background:white;
opacity:.25;
animation:floatUp linear infinite;
}

@keyframes floatUp{
0%{transform:translateY(100vh) scale(.5);opacity:0;}
20%{opacity:.4;}
80%{opacity:.3;}
100%{transform:translateY(-10vh) scale(1.2);opacity:0;}
}

/* reveal screen */
#reveal{
position:fixed;
top:0;
left:0;
width:100%;
height:100%;
background:black;
color:#ddd;
padding:25px;
overflow:auto;
display:none;
z-index:9999;
text-align:center;
}

#revealContent{
white-space:pre-wrap;
margin-top:20px;
font-size:18px;
}
</style>
</head>

<body>

<div class="bg"></div>

<div class="container">
<div class="title">write what you cannot tell anyone</div>

<textarea id="t" placeholder="..."></textarea><br>
<button onclick="dissolve()">DISSOLVE</button>
</div>

<div id="layer"></div>

<div id="reveal">
<h2>Your forgotten thoughts</h2>
<div id="revealContent"></div>

<br>
<button onclick="copyText()">COPY</button>
<button onclick="downloadPDF()">PDF</button>
<button onclick="downloadImage()">IMAGE</button>

<p style="color:#666;margin-top:20px;">disappears in 24 hours</p>
</div>

<audio id="music">
<source src="https://www.dropbox.com/scl/fi/dud2qh1ofoowl1g0nnazk/km_20260207_360p_30f_20260210_114730-mc.mp3?rlkey=jzftzlfl3pgbehvlaczz39cgb&raw=1">
</audio>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>

<script>
// particles
function startParticles(){
let container=document.createElement("div");
container.className="particles";
document.body.appendChild(container);

for(let i=0;i<80;i++){
let dot=document.createElement("div");
dot.className="p";
dot.style.left=Math.random()*100+"vw";
dot.style.animationDuration=(6+Math.random()*12)+"s";
dot.style.animationDelay=Math.random()*5+"s";
container.appendChild(dot);
}
}
startParticles();

// dissolve
function dissolve(){
let box=document.getElementById("t");
let text=box.value.trim();
if(text==="") return;

let music=document.getElementById("music");
let layer=document.getElementById("layer");

// save start date
if(!localStorage.getItem("startDate")){
localStorage.setItem("startDate",new Date().toISOString());
}

// save thought
let thoughts=JSON.parse(localStorage.getItem("thoughts"))||[];
thoughts.push({text:text,time:new Date().toISOString()});
localStorage.setItem("thoughts",JSON.stringify(thoughts));

// music
music.volume=.7;
music.play();

// move text
layer.innerHTML="";
for(let char of text){
let span=document.createElement("span");
span.innerText=char;
span.className="letter";
layer.appendChild(span);
}

box.value="";
box.style.opacity=0;

setTimeout(()=>{
let letters=document.querySelectorAll(".letter");
letters.forEach((l,i)=>{
setTimeout(()=>{
l.classList.add("fly");
},i*140);
});
},1000);

setTimeout(()=>{
layer.innerHTML="";
box.style.opacity=1;

let fade=setInterval(()=>{
if(music.volume>0.05){music.volume-=0.05;}
else{music.pause();clearInterval(fade);}
},200);

},18000);
}

// reveal after 30 days
function check(){
let start=localStorage.getItem("startDate");
if(!start) return;

let startDate=new Date(start);
let now=new Date();
let diff=Math.floor((now-startDate)/(1000*60*60*24));

if(diff>=30){showReveal();}
}
check();

function showReveal(){
let reveal=document.getElementById("reveal");
let content=document.getElementById("revealContent");
let thoughts=JSON.parse(localStorage.getItem("thoughts"))||[];

let text="";
thoughts.forEach(t=>text+=t.text+"\n\n");

reveal.style.display="block";
content.innerText=text;

if(!localStorage.getItem("revealTime")){
localStorage.setItem("revealTime",new Date().toISOString());
}

autoDelete();
}

// auto delete 24h
function autoDelete(){
let r=localStorage.getItem("revealTime");
if(!r) return;

let opened=new Date(r);
let now=new Date();
let diff=now-opened;
let limit=24*60*60*1000;

if(diff>=limit){
localStorage.clear();
location.reload();
}else{
setTimeout(()=>{
localStorage.clear();
location.reload();
},limit-diff);
}
}

// copy
function copyText(){
let text=document.getElementById("revealContent").innerText;
navigator.clipboard.writeText(text);
alert("Copied");
}

// pdf
function downloadPDF(){
let text=document.getElementById("revealContent").innerText;
const { jsPDF } = window.jspdf;
const doc=new jsPDF();
doc.text(text,10,10);
doc.save("thoughts.pdf");
}

// image
function downloadImage(){
let box=document.getElementById("revealContent");
html2canvas(box).then(canvas=>{
let link=document.createElement("a");
link.download="thoughts.png";
link.href=canvas.toDataURL();
link.click();
});
}
</script>

</body>
</html>
