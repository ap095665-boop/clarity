<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Void</title>

<style>
html,body{
margin:0;
padding:0;
background:black;
font-family:monospace;
height:100%;
overflow:hidden;
color:#aaa;
}

/* center container */
.container{
position:absolute;
top:50%;
left:50%;
transform:translate(-50%,-50%);
width:92%;
max-width:700px;
text-align:center;
}

.title{
color:#666;
margin-bottom:25px;
font-size:20px;
letter-spacing:2px;
}

textarea{
width:100%;
height:200px;
background:rgba(0,0,0,.6);
border:1px solid #333;
color:#fff;
font-size:22px;
padding:20px;
outline:none;
resize:none;
}

button{
margin-top:25px;
padding:16px 45px;
background:black;
color:#aaa;
border:1px solid #444;
font-size:15px;
letter-spacing:4px;
}

/* dissolve layer */
#layer{
position:absolute;
top:50%;
left:50%;
transform:translate(-50%,-50%);
width:92%;
max-width:700px;
font-size:26px;
color:white;
line-height:1.6;
text-align:center;
pointer-events:none;
}

/* letters */
.letter{
display:inline-block;
transition:all 9s linear;
opacity:1;
}

.fly{
opacity:0;
transform:translateY(-220px) scale(2.2) rotate(25deg);
filter:blur(10px);
}

/* animated background */
.bg{
position:fixed;
width:200%;
height:200%;
top:-50%;
left:-50%;
background:radial-gradient(circle,#111 0%,black 60%);
animation:bgmove 20s linear infinite;
opacity:.7;
z-index:-2;
}

@keyframes bgmove{
0%{transform:scale(1);}
50%{transform:scale(1.4);}
100%{transform:scale(1);}
}

/* particles */
.particles{
position:fixed;
width:100%;
height:100%;
background:url('https://i.imgur.com/YKY28eT.png');
opacity:.25;
animation:float 18s linear forwards;
z-index:-1;
}

@keyframes float{
0%{opacity:0;}
20%{opacity:.25;}
60%{opacity:.5;}
100%{opacity:0;}
}

/* reveal screen */
#reveal{
position:fixed;
top:0;
left:0;
width:100%;
height:100%;
background:black;
color:#ddd;
padding:40px;
overflow:auto;
display:none;
z-index:9999;
white-space:pre-wrap;
}
</style>
</head>

<body>

<div class="bg"></div>

<div class="container">
<div class="title">write what you cannot tell anyone</div>

<textarea id="t" placeholder="..."></textarea><br>
<button onclick="dissolve()">DISSOLVE</button>
</div>

<div id="layer"></div>
<div id="reveal"></div>

<audio id="music">
<source src="https://www.dropbox.com/scl/fi/dud2qh1ofoowl1g0nnazk/km_20260207_360p_30f_20260210_114730-mc.mp3?rlkey=jzftzlfl3pgbehvlaczz39cgb&raw=1">
</audio>

<script>
function dissolve(){

let box=document.getElementById("t");
let text=box.value.trim();
if(text==="") return;

let music=document.getElementById("music");
let layer=document.getElementById("layer");

// store start date
if(!localStorage.getItem("startDate")){
localStorage.setItem("startDate",new Date().toISOString());
}

// save thought
let thoughts=JSON.parse(localStorage.getItem("thoughts"))||[];
thoughts.push({text:text,time:new Date().toISOString()});
localStorage.setItem("thoughts",JSON.stringify(thoughts));

// start music
music.volume=.7;
music.play();

// particles
let p=document.createElement("div");
p.className="particles";
document.body.appendChild(p);

// move text to layer
layer.innerHTML="";
for(let char of text){
let span=document.createElement("span");
span.innerText=char;
span.className="letter";
layer.appendChild(span);
}

// hide textarea
box.value="";
box.style.opacity=0;

// dissolve slowly
setTimeout(()=>{
let letters=document.querySelectorAll(".letter");
letters.forEach((l,i)=>{
setTimeout(()=>{
l.classList.add("fly");
},i*140);
});
},1000);

// finish after music
setTimeout(()=>{
layer.innerHTML="";
box.style.opacity=1;

let fade=setInterval(()=>{
if(music.volume>0.05){music.volume-=0.05;}
else{music.pause();clearInterval(fade);}
},200);

p.remove();

},18000);
}

// ===== reveal system =====
function check(){
let start=localStorage.getItem("startDate");
if(!start) return;

let startDate=new Date(start);
let now=new Date();
let diff=Math.floor((now-startDate)/(1000*60*60*24));

if(diff>=30){
showReveal();
}
}
check();

function showReveal(){
let reveal=document.getElementById("reveal");
let thoughts=JSON.parse(localStorage.getItem("thoughts"))||[];

let text="Your forgotten thoughts:\n\n";
thoughts.forEach(t=>text+=t.text+"\n\n");

reveal.style.display="block";
reveal.innerText=text;

if(!localStorage.getItem("revealTime")){
localStorage.setItem("revealTime",new Date().toISOString());
}

autoDelete();
}

function autoDelete(){
let r=localStorage.getItem("revealTime");
if(!r) return;

let opened=new Date(r);
let now=new Date();
let diff=now-opened;
let limit=24*60*60*1000;

if(diff>=limit){
localStorage.clear();
location.reload();
}else{
setTimeout(()=>{
localStorage.clear();
location.reload();
},limit-diff);
}
}
</script>

</body>
</html>
